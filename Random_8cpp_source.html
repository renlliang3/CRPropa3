<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CRPropa 3: Random.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CRPropa 3
   </div>
   <div id="projectbrief">Propagation of ultra-relativistic particles through galactic and extragalactic space</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Building&#160;Blocks</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Random.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Random.cpp is based on Random.h</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Mersenne Twister random number generator -- a C++ class Random</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Based on code by Makoto Matsumoto, Takuji Nishimura, and Shawn Cokus</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Richard J. Wagner  v1.0  15 May 2003  rjwagner@writeme.com</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// The Mersenne Twister is an algorithm for generating random numbers.  It</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// was designed with consideration of the flaws in various other generators.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// The period, 2^19937-1, and the order of equidistribution, 623 dimensions,</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// are far greater.  The generator is also fast; it avoids multiplication and</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// division, and it benefits from caches and pipelines.  For more information</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// see the inventors&#39; web page at http://www.math.keio.ac.jp/~matumoto/emt.html</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// Reference</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// M. Matsumoto and T. Nishimura, &quot;Mersenne Twister: A 623-Dimensionally</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// Equidistributed Uniform Pseudo-Random Number Generator&quot;, ACM Transactions on</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// Modeling and Computer Simulation, Vol. 8, No. 1, January 1998, pp 3-30.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// Copyright (C) 2000 - 2003, Richard J. Wagner</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// All rights reserved.                          </span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// Redistribution and use in source and binary forms, with or without</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// modification, are permitted provided that the following conditions</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// are met:</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//   1. Redistributions of source code must retain the above copyright</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//      notice, this list of conditions and the following disclaimer.</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//   2. Redistributions in binary form must reproduce the above copyright</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//      notice, this list of conditions and the following disclaimer in the</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//      documentation and/or other materials provided with the distribution.</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//   3. The names of its contributors may not be used to endorse or promote </span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//      products derived from this software without specific prior written </span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//      permission.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">// &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// The original code included the following notice:</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//     When you use this, send an email to: matumoto@math.keio.ac.jp</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//     with an appropriate reference to your work.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">// It would be nice to CC: rjwagner@writeme.com and Cokus@math.washington.edu</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">// when you write.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">// Parts of this file are modified beginning in 29.10.09 for adaption in PXL.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">// Parts of this file are modified beginning in 10.02.12 for adaption in CRPropa.</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;crpropa/Random.h&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;crpropa/base64.h&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &lt;cstdio&gt;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacecrpropa.html">crpropa</a> {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="group__Core.html#a56b1112275f5ed766fc77897514bb982">   68</a></span>&#160;<a class="code" href="group__Core.html#aa0cd23a16025cfeef7b8810eeb2a5d36">Random::Random</a>(<span class="keyword">const</span> uint32_t&amp; oneSeed) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">seed</a>(oneSeed);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<a class="code" href="group__Core.html#aa0cd23a16025cfeef7b8810eeb2a5d36">Random::Random</a>(uint32_t * <span class="keyword">const</span> bigSeed, <span class="keyword">const</span> uint32_t seedLength) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">seed</a>(bigSeed, seedLength);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="group__Core.html#aa0cd23a16025cfeef7b8810eeb2a5d36">   76</a></span>&#160;<a class="code" href="group__Core.html#aa0cd23a16025cfeef7b8810eeb2a5d36">Random::Random</a>() {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">seed</a>();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">   80</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">Random::rand</a>() {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">return</span> double(<a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">randInt</a>()) * (1.0 / 4294967295.0);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="group__Core.html#a6b54c1bfd54a46e292478870554eb4d0">   84</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">Random::rand</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; n) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>() * n;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="group__Core.html#adfd027765dc6de35f4305204edf51622">   88</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#adfd027765dc6de35f4305204edf51622">Random::randExc</a>() {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">return</span> double(<a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">randInt</a>()) * (1.0 / 4294967296.0);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="group__Core.html#ad9888d54bf71c0c6bb5941394a0e5651">   92</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#adfd027765dc6de35f4305204edf51622">Random::randExc</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; n) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__Core.html#adfd027765dc6de35f4305204edf51622">randExc</a>() * n;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="group__Core.html#a540919a8c8868928fffce58c66d1b91e">   96</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#a540919a8c8868928fffce58c66d1b91e">Random::randDblExc</a>() {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">double</span>(<a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">randInt</a>()) + 0.5) * (1.0 / 4294967296.0);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="group__Core.html#a680cbcf457bdc668d1a4d9a1c8bb882b">  100</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#a540919a8c8868928fffce58c66d1b91e">Random::randDblExc</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; n) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__Core.html#a540919a8c8868928fffce58c66d1b91e">randDblExc</a>() * n;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="group__Core.html#ae021627627a0dbdbd19b503a3955dcc9">  104</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#ae021627627a0dbdbd19b503a3955dcc9">Random::rand53</a>() {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        uint32_t a = <a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">randInt</a>() &gt;&gt; 5, b = <a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">randInt</a>() &gt;&gt; 6;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">return</span> (a * 67108864.0 + b) * (1.0 / 9007199254740992.0); <span class="comment">// by Isaku Wada</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">// Return a real number from a normal (Gaussian) distribution with given</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">// mean and variance by Box-Muller method</span></div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="group__Core.html#aa9ff74123d4d205b49c9c8c44b2b3af3">  111</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#aa9ff74123d4d205b49c9c8c44b2b3af3">Random::randNorm</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; mean, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; variance) {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordtype">double</span> r = sqrt(-2.0 * log(1.0 - <a class="code" href="group__Core.html#a540919a8c8868928fffce58c66d1b91e">randDblExc</a>())) * variance;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordtype">double</span> phi = 2.0 * 3.14159265358979323846264338328 * <a class="code" href="group__Core.html#adfd027765dc6de35f4305204edf51622">randExc</a>();</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">return</span> mean + r * cos(phi);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="group__Core.html#a676ea228bb8be981a245f243599be2ba">  117</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#a676ea228bb8be981a245f243599be2ba">Random::randUniform</a>(<span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">return</span> min + (max - min) * <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="group__Core.html#a22b7848147a9fecaa227fe4170ae6c6f">  121</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#a22b7848147a9fecaa227fe4170ae6c6f">Random::randRayleigh</a>(<span class="keywordtype">double</span> sigma) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">return</span> sigma * sqrt(-2.0 * log(1 - <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>()));</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="group__Core.html#a0ef89b01dbab3b7af11d83ebbb088caf">  125</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#a0ef89b01dbab3b7af11d83ebbb088caf">Random::randFisher</a>(<span class="keywordtype">double</span> kappa) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">return</span> acos(1. + 1. / kappa * log(1 - <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>() * (1 - exp(-2 * kappa))));</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="group__Core.html#ab70ffcf4477320f22f8c4b70756f60ed">  129</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="group__Core.html#ab70ffcf4477320f22f8c4b70756f60ed">Random::randBin</a>(<span class="keyword">const</span> std::vector&lt;float&gt; &amp;cdf) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        std::vector&lt;float&gt;::const_iterator it = std::lower_bound(cdf.begin(),</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                        cdf.end(), <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>() * cdf.back());</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">return</span> it - cdf.begin();</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="group__Core.html#ab70ffcf4477320f22f8c4b70756f60ed">Random::randBin</a>(<span class="keyword">const</span> std::vector&lt;double&gt; &amp;cdf) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        std::vector&lt;double&gt;::const_iterator it = std::lower_bound(cdf.begin(),</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        cdf.end(), <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>() * cdf.back());</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">return</span> it - cdf.begin();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="group__Core.html#a72fcc3b309bcab75050c60ffa2659e3e">  141</a></span>&#160;<a class="code" href="group__Core.html">Vector3d</a> <a class="code" href="group__Core.html#a72fcc3b309bcab75050c60ffa2659e3e">Random::randVector</a>() {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordtype">double</span> z = <a class="code" href="group__Core.html#a676ea228bb8be981a245f243599be2ba">randUniform</a>(-1.0, 1.0);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">double</span> t = <a class="code" href="group__Core.html#a676ea228bb8be981a245f243599be2ba">randUniform</a>(-1.0 * M_PI, M_PI);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordtype">double</span> r = sqrt(1 - z * z);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__Core.html">Vector3d</a>(r * cos(t), r * sin(t), z);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="group__Core.html#a61c9eacb9b10051428e5302d47b43c6f">  148</a></span>&#160;<a class="code" href="group__Core.html">Vector3d</a> <a class="code" href="group__Core.html#a61c9eacb9b10051428e5302d47b43c6f">Random::randVectorAroundMean</a>(<span class="keyword">const</span> <a class="code" href="group__Core.html">Vector3d</a> &amp;meanDirection,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="keywordtype">double</span> angle) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="group__Core.html">Vector3d</a> axis = meanDirection.cross(<a class="code" href="group__Core.html#a72fcc3b309bcab75050c60ffa2659e3e">randVector</a>());</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="group__Core.html">Vector3d</a> v = meanDirection;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">return</span> v.getRotated(axis, angle);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="group__Core.html#a59845772e010c85222696da08143282d">  155</a></span>&#160;<a class="code" href="group__Core.html">Vector3d</a> <a class="code" href="group__Core.html#a59845772e010c85222696da08143282d">Random::randFisherVector</a>(<span class="keyword">const</span> <a class="code" href="group__Core.html">Vector3d</a> &amp;meanDirection, <span class="keywordtype">double</span> kappa) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__Core.html#a61c9eacb9b10051428e5302d47b43c6f">randVectorAroundMean</a>(meanDirection, <a class="code" href="group__Core.html#a0ef89b01dbab3b7af11d83ebbb088caf">randFisher</a>(kappa));</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="group__Core.html#a81c75a710fe75ed3ea662b23591dd171">  159</a></span>&#160;<a class="code" href="group__Core.html">Vector3d</a> <a class="code" href="group__Core.html#a81c75a710fe75ed3ea662b23591dd171">Random::randConeVector</a>(<span class="keyword">const</span> <a class="code" href="group__Core.html">Vector3d</a> &amp;meanDirection, <span class="keywordtype">double</span> angularRadius) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> theta = acos(<a class="code" href="group__Core.html#a676ea228bb8be981a245f243599be2ba">randUniform</a>(1, cos(angularRadius)));</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__Core.html#a61c9eacb9b10051428e5302d47b43c6f">randVectorAroundMean</a>(meanDirection, theta);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="group__Core.html#a546a92d9acde0f1337fb3c80787ac4b6">  164</a></span>&#160;<a class="code" href="group__Core.html">Vector3d</a> <a class="code" href="group__Core.html#a546a92d9acde0f1337fb3c80787ac4b6">Random::randVectorLamberts</a>() {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">// random vector following Lamberts cosine law (https://en.wikipedia.org/wiki/Lambert%27s_cosine_law)</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// for a surface element with normal vector pointing in positive z-axis (0, 0, 1)</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordtype">double</span> phi = <a class="code" href="group__Core.html#a676ea228bb8be981a245f243599be2ba">randUniform</a>(-1.0 * M_PI, M_PI);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordtype">double</span> theta = M_PI / 2.0 - acos(sqrt(<a class="code" href="group__Core.html#a676ea228bb8be981a245f243599be2ba">randUniform</a>(0, 1)));</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__Core.html">Vector3d</a>(cos(phi) * cos(theta), sin(phi) * cos(theta), sin(theta));</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="group__Core.html#a74914699e2bb54084f582a86f2a2a014">  172</a></span>&#160;<a class="code" href="group__Core.html">Vector3d</a> <a class="code" href="group__Core.html#a546a92d9acde0f1337fb3c80787ac4b6">Random::randVectorLamberts</a>(<span class="keyword">const</span> <a class="code" href="group__Core.html">Vector3d</a> &amp;normalVector) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// random vector following Lamberts cosine law for a surface element described by normalVector</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="group__Core.html">Vector3d</a> vLambertz = <a class="code" href="group__Core.html#a546a92d9acde0f1337fb3c80787ac4b6">randVectorLamberts</a>();</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// find rotation axis that rotates the z-axis to the normalVector of the surface element</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="group__Core.html">Vector3d</a> axis = normalVector.cross(<a class="code" href="group__Core.html">Vector3d</a>(0, 0, 1));</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> (axis.getR() &lt; std::numeric_limits&lt;double&gt;::epsilon()) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                axis = <a class="code" href="group__Core.html">Vector3d</a>(0, 0, 1);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordtype">double</span> angle = normalVector.getAngleTo(<a class="code" href="group__Core.html">Vector3d</a>(0, 0, 1));</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// rotate the random Lamberts vector from z-axis to respective surface element</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">return</span> vLambertz.getRotated(axis / axis.getR(), -angle);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="group__Core.html#abcd421d6ac5d8720014afa6e6e9ec9af">  185</a></span>&#160;<a class="code" href="group__Core.html">Vector3d</a> <a class="code" href="group__Core.html#abcd421d6ac5d8720014afa6e6e9ec9af">Random::randomInterpolatedPosition</a>(<span class="keyword">const</span> <a class="code" href="group__Core.html">Vector3d</a> &amp;a, <span class="keyword">const</span> <a class="code" href="group__Core.html">Vector3d</a> &amp;b) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">return</span> a + <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>() * (b - a);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="group__Core.html#a0cd29fd1c9f315dbd0630fc3462d9831">  189</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#a0cd29fd1c9f315dbd0630fc3462d9831">Random::randPowerLaw</a>(<span class="keywordtype">double</span> index, <span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span> ((min &lt; 0) || (max &lt; min)) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordflow">throw</span> std::runtime_error(</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                <span class="stringliteral">&quot;Power law distribution only possible for 0 &lt;= min &lt;= max&quot;</span>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">//check for index -1!</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">if</span> ((std::abs(index + 1.0)) &lt; std::numeric_limits&lt;double&gt;::epsilon()) {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordtype">double</span> part1 = log(max);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordtype">double</span> part2 = log(min);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="keywordflow">return</span> exp((part1 - part2) * <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>() + part2);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <span class="keywordtype">double</span> part1 = pow(max, index + 1);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordtype">double</span> part2 = pow(min, index + 1);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="keywordtype">double</span> ex = 1 / (index + 1);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                <span class="keywordflow">return</span> pow((part1 - part2) * <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>() + part2, ex);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="group__Core.html#abb08d2082cd8525b8968d45ba6b06378">  207</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#abb08d2082cd8525b8968d45ba6b06378">Random::randBrokenPowerLaw</a>(<span class="keywordtype">double</span> index1, <span class="keywordtype">double</span> index2,</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keywordtype">double</span> breakpoint, <span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max) {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span> ((min &lt;= 0) || (max &lt; min)) {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="keywordflow">throw</span> std::runtime_error(</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                <span class="stringliteral">&quot;Power law distribution only possible for 0 &lt; min &lt;= max&quot;</span>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">if</span> (min &gt;= breakpoint) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="keywordflow">return</span> this-&gt;<a class="code" href="group__Core.html#a0cd29fd1c9f315dbd0630fc3462d9831">randPowerLaw</a>(index2, min, max);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (max &lt;= breakpoint) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keywordflow">return</span> this-&gt;<a class="code" href="group__Core.html#a0cd29fd1c9f315dbd0630fc3462d9831">randPowerLaw</a>(index2, min, max);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="keywordtype">double</span> intPL1;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="comment">// check if index1 = -1</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keywordflow">if</span> ((std::abs(index1 + 1.0)) &lt; std::numeric_limits&lt;double&gt;::epsilon()) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                        intPL1 = log(breakpoint / min);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                        intPL1 = (pow(breakpoint, index1 + 1) - pow(min, index1 + 1))</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                        / (index1 + 1);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keywordtype">double</span> intPL2;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="comment">// check if index2 = -1</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">if</span> ((std::abs(index2 + 1.0)) &lt; std::numeric_limits&lt;double&gt;::epsilon()) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                        intPL2 = log(max / breakpoint) * pow(breakpoint, index1 - index2);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                        intPL2 = (pow(max, index2 + 1) - pow(breakpoint, index2 + 1))</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                        * pow(breakpoint, index1 - index2) / (index2 + 1);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>() &gt; intPL1 / (intPL1 + intPL2))</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="group__Core.html#a0cd29fd1c9f315dbd0630fc3462d9831">randPowerLaw</a>(index2, breakpoint, max);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="group__Core.html#a0cd29fd1c9f315dbd0630fc3462d9831">randPowerLaw</a>(index1, min, breakpoint);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="group__Core.html#a4b16357aa8da99122fa67aaba2653d68">  241</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="group__Core.html#a4b16357aa8da99122fa67aaba2653d68">Random::randExponential</a>() {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordtype">double</span> dum;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">do</span> {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                dum = <a class="code" href="group__Core.html#a78309d923f245b6acf167260194ba6e1">rand</a>();</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        } <span class="keywordflow">while</span> (dum &lt; std::numeric_limits&lt;double&gt;::epsilon());</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">return</span> -1.0 * log(dum);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">  249</a></span>&#160;uint32_t <a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">Random::randInt</a>() {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span> (left == 0)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <a class="code" href="group__Core.html#af0de4b4127be745f3a835f316c6d2d03">reload</a>();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        --left;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        uint32_t s1;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        s1 = *pNext++;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        s1 ^= (s1 &gt;&gt; 11);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        s1 ^= (s1 &lt;&lt; 7) &amp; 0x9d2c5680UL;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        s1 ^= (s1 &lt;&lt; 15) &amp; 0xefc60000UL;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">return</span> (s1 ^ (s1 &gt;&gt; 18));</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="group__Core.html#a878fbf49dbc79913221d45739fa92bf5">  262</a></span>&#160;uint32_t <a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">Random::randInt</a>(<span class="keyword">const</span> uint32_t&amp; n) {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">// Find which bits are used in n</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">// Optimized by Magnus Jonsson (magnus@smartelectronix.com)</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        uint32_t used = n;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        used |= used &gt;&gt; 1;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        used |= used &gt;&gt; 2;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        used |= used &gt;&gt; 4;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        used |= used &gt;&gt; 8;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        used |= used &gt;&gt; 16;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">// Draw numbers until one is found in [0,n]</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        uint32_t i;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                i = <a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">randInt</a>() &amp; used; <span class="comment">// toss unused bits to shorten search</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">while</span> (i &gt; n);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">return</span> i;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="group__Core.html#a957487771e79552480efa2f2ed887261">  281</a></span>&#160;uint64_t <a class="code" href="group__Core.html#a957487771e79552480efa2f2ed887261">Random::randInt64</a>()</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;{</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        int64_t a = <a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">randInt</a>();</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        int64_t b = <a class="code" href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">randInt</a>();</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">return</span> (b + a &lt;&lt; 32);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="group__Core.html#a87c673ee0416521c657d34434ea4bfeb">  289</a></span>&#160;uint64_t <a class="code" href="group__Core.html#a957487771e79552480efa2f2ed887261">Random::randInt64</a>(<span class="keyword">const</span> uint64_t &amp;n)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        uint64_t used = n;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        used |= used &gt;&gt; 1;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        used |= used &gt;&gt; 2;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        used |= used &gt;&gt; 4;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        used |= used &gt;&gt; 8;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        used |= used &gt;&gt; 16;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        used |= used &gt;&gt; 32;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// Draw numbers until one is found in [0,n]</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        uint64_t i;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                i = <a class="code" href="group__Core.html#a957487771e79552480efa2f2ed887261">randInt64</a>() &amp; used; <span class="comment">// toss unused bits to shorten search</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">while</span> (i &gt; n);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">return</span> i;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="group__Core.html#af236dea62d3fe3989b66efea3d803d6c">  309</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">Random::seed</a>(<span class="keyword">const</span> uint32_t oneSeed) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        initial_seed.resize(1);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        initial_seed[0] = oneSeed;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="group__Core.html#a4be5586c72dbb90585801c742f4f3c92">initialize</a>(oneSeed);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="group__Core.html#af0de4b4127be745f3a835f316c6d2d03">reload</a>();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="group__Core.html#a7a771913a48046baa7a1d030fc95919d">  316</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">Random::seed</a>(uint32_t * <span class="keyword">const</span> bigSeed, <span class="keyword">const</span> uint32_t seedLength) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        initial_seed.resize(seedLength);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i =0; i&lt; seedLength; i++)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                initial_seed[i] = bigSeed[i];</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <a class="code" href="group__Core.html#a4be5586c72dbb90585801c742f4f3c92">initialize</a>(19650218UL);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordtype">int</span> i = 1;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        uint32_t j = 0;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordtype">int</span> k = (N &gt; seedLength ? N : seedLength);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">for</span> (; k; --k) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                state[i] = state[i]</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                ^ ((state[i - 1] ^ (state[i - 1] &gt;&gt; 30)) * 1664525UL);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                state[i] += (bigSeed[j] &amp; 0xffffffffUL) + j;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                state[i] &amp;= 0xffffffffUL;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                ++i;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                ++j;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="keywordflow">if</span> (i &gt;= N) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                        state[0] = state[N - 1];</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        i = 1;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                }</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <span class="keywordflow">if</span> (j &gt;= seedLength)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        j = 0;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">for</span> (k = N - 1; k; --k) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                state[i] = state[i]</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                ^ ((state[i - 1] ^ (state[i - 1] &gt;&gt; 30)) * 1566083941UL);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                state[i] -= i;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                state[i] &amp;= 0xffffffffUL;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                ++i;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="keywordflow">if</span> (i &gt;= N) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                        state[0] = state[N - 1];</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                        i = 1;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        state[0] = 0x80000000UL; <span class="comment">// MSB is 1, assuring non-zero initial array</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="group__Core.html#af0de4b4127be745f3a835f316c6d2d03">reload</a>();</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;}</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">  357</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">Random::seed</a>() {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">// First try getting an array from /dev/urandom</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        FILE* urandom = std::fopen(<span class="stringliteral">&quot;/dev/urandom&quot;</span>, <span class="stringliteral">&quot;rb&quot;</span>);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">if</span> (urandom) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                uint32_t bigSeed[N];</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                uint32_t *s = bigSeed;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keywordtype">int</span> i = N;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keywordtype">bool</span> success = <span class="keyword">true</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <span class="keywordflow">while</span> (success &amp;&amp; i--)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                        success = std::fread(s++, <span class="keyword">sizeof</span>(uint32_t), 1, urandom) != 0;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                std::fclose(urandom);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="keywordflow">if</span> (success) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                        <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">seed</a>(bigSeed, N);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">// Was not successful, so use time() and clock() instead</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">seed</a>(<a class="code" href="group__Core.html#ae4ba0f616e8362a265632cb6ab796b52">hash</a>(time(NULL), clock()));</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="group__Core.html#a4be5586c72dbb90585801c742f4f3c92">  379</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__Core.html#a4be5586c72dbb90585801c742f4f3c92">Random::initialize</a>(<span class="keyword">const</span> uint32_t <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">seed</a>) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        uint32_t *s = state;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        uint32_t *r = state;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordtype">int</span> i = 1;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        *s++ = seed &amp; 0xffffffffUL;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">for</span> (; i &lt; N; ++i) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                *s++ = (1812433253UL * (*r ^ (*r &gt;&gt; 30)) + i) &amp; 0xffffffffUL;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                r++;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="group__Core.html#af0de4b4127be745f3a835f316c6d2d03">  390</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__Core.html#af0de4b4127be745f3a835f316c6d2d03">Random::reload</a>() {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        uint32_t *p = state;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">for</span> (i = N - M; i--; ++p)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                *p = twist(p[M], p[0], p[1]);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">for</span> (i = M; --i; ++p)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                *p = twist(p[M - N], p[0], p[1]);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        *p = twist(p[M - N], p[0], state[0]);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        left = N, pNext = state;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="group__Core.html#ae4ba0f616e8362a265632cb6ab796b52">  402</a></span>&#160;uint32_t <a class="code" href="group__Core.html#ae4ba0f616e8362a265632cb6ab796b52">Random::hash</a>(time_t t, clock_t c) {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keyword">static</span> uint32_t differ = 0; <span class="comment">// guarantee time-based seeds will change</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        uint32_t h1 = 0;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) &amp;t;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <span class="keyword">sizeof</span>(t); ++i) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                h1 *= std::numeric_limits&lt;unsigned char&gt;::max() + 2U;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                h1 += p[i];</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        uint32_t h2 = 0;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        p = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) &amp;c;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <span class="keyword">sizeof</span>(c); ++j) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                h2 *= std::numeric_limits&lt;unsigned char&gt;::max() + 2U;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                h2 += p[j];</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">return</span> (h1 + differ++) ^ h2;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordtype">void</span> Random::save(uint32_t* saveArray)<span class="keyword"> const </span>{</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        uint32_t *sa = saveArray;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keyword">const</span> uint32_t *s = state;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordtype">int</span> i = N;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">for</span> (; i--; *sa++ = *s++) {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        *sa = left;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keyword">const</span> std::vector&lt;uint32_t&gt; &amp;Random::getSeed()<span class="keyword"> const</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">return</span> initial_seed;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="keywordtype">void</span> Random::load(uint32_t * <span class="keyword">const</span> loadArray) {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        uint32_t *s = state;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        uint32_t *la = loadArray;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordtype">int</span> i = N;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">for</span> (; i--; *s++ = *la++) {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        left = *la;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        pNext = &amp;state[N - left];</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;std::ostream&amp; operator&lt;&lt;(std::ostream&amp; os, <span class="keyword">const</span> <a class="code" href="group__Core.html#classcrpropa_1_1Random">Random</a>&amp; mtrand) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keyword">const</span> uint32_t *s = mtrand.state;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordtype">int</span> i = mtrand.N;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">for</span> (; i--; os &lt;&lt; *s++ &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">return</span> os &lt;&lt; mtrand.left;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;std::istream&amp; operator&gt;&gt;(std::istream&amp; is, <a class="code" href="group__Core.html#classcrpropa_1_1Random">Random</a>&amp; mtrand) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        uint32_t *s = mtrand.state;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordtype">int</span> i = mtrand.N;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">for</span> (; i--; is &gt;&gt; *s++) {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        is &gt;&gt; mtrand.left;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        mtrand.pNext = &amp;mtrand.state[mtrand.N - mtrand.left];</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">return</span> is;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor">#include &lt;omp.h&gt;</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">// see http://stackoverflow.com/questions/8051108/using-the-openmp-threadprivate-directive-on-static-instances-of-c-stl-types</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">int</span> MAX_THREAD = 256;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keyword">struct </span>RANDOM_TLS_ITEM {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="group__Core.html#classcrpropa_1_1Random">Random</a> r;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordtype">char</span> padding[(<span class="keyword">sizeof</span>(<a class="code" href="group__Core.html#aa0cd23a16025cfeef7b8810eeb2a5d36">Random</a>) / 64 + 1) * 64 - <span class="keyword">sizeof</span>(<a class="code" href="group__Core.html#aa0cd23a16025cfeef7b8810eeb2a5d36">Random</a>)];</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;};</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#ifdef _MSC_VER</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;__declspec(align(64)) <span class="keyword">static</span> RANDOM_TLS_ITEM _tls[MAX_THREAD];</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;__attribute__ ((aligned(64))) <span class="keyword">static</span> RANDOM_TLS_ITEM _tls[MAX_THREAD];</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<a class="code" href="group__Core.html#classcrpropa_1_1Random">Random</a> &amp;Random::instance() {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordtype">int</span> i = omp_get_thread_num();</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">if</span> (i &gt;= MAX_THREAD)</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;crpropa::Random: more than MAX_THREAD threads!&quot;</span>);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">return</span> _tls[i].r;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="keywordtype">void</span> Random::seedThreads(<span class="keyword">const</span> uint32_t oneSeed) {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; MAX_THREAD; ++i)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        _tls[i].r.seed(oneSeed + i);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;std::vector&lt; std::vector&lt;uint32_t&gt; &gt; Random::getSeedThreads()</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;{</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        std::vector&lt; std::vector&lt;uint32_t&gt; &gt; seeds;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; omp_get_num_threads(); ++i)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                seeds.push_back(_tls[i].r.getSeed() ); </div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">return</span> seeds;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keyword">static</span> <a class="code" href="group__Core.html#classcrpropa_1_1Random">Random</a> _random;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<a class="code" href="group__Core.html#classcrpropa_1_1Random">Random</a> &amp;Random::instance() {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">return</span> _random;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;}</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keywordtype">void</span> Random::seedThreads(<span class="keyword">const</span> uint32_t oneSeed) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        _random.<a class="code" href="group__Core.html#af236dea62d3fe3989b66efea3d803d6c">seed</a>(oneSeed);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;}</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;std::vector&lt; std::vector&lt;uint32_t&gt; &gt; Random::getSeedThreads()</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;{</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        std::vector&lt; std::vector&lt;uint32_t&gt; &gt; seeds;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                seeds.push_back(_random.getSeed() ); </div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">return</span> seeds;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="keyword">const</span> std::string Random::getSeed_base64()<span class="keyword"> const</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classcrpropa_1_1Base64.html#ac4125aa2e036339b53fefabaab922bd5">Base64::encode</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) &amp;initial_seed[0], <span class="keyword">sizeof</span>(initial_seed[0]) * initial_seed.size() / <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> char));</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">Random::seed</a>(<span class="keyword">const</span> std::string &amp;b64Seed)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;{</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        std::string decoded_data = Base64::decode(b64Seed);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordtype">size_t</span> seedSize = decoded_data.size() * <span class="keyword">sizeof</span>(decoded_data[0]) / <span class="keyword">sizeof</span>(uint32_t);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">seed</a>((uint32_t*)decoded_data.c_str(), seedSize );</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;} <span class="comment">// namespace crpropa</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="ttc" id="group__Core_html_a4b16357aa8da99122fa67aaba2653d68"><div class="ttname"><a href="group__Core.html#a4b16357aa8da99122fa67aaba2653d68">crpropa::Random::randExponential</a></div><div class="ttdeci">double randExponential()</div><div class="ttdoc">Exponential distribution in (0,inf) </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00241">Random.cpp:241</a></div></div>
<div class="ttc" id="group__Core_html_aa9ff74123d4d205b49c9c8c44b2b3af3"><div class="ttname"><a href="group__Core.html#aa9ff74123d4d205b49c9c8c44b2b3af3">crpropa::Random::randNorm</a></div><div class="ttdeci">double randNorm(const double &amp;mean=0.0, const double &amp;variance=1.0)</div><div class="ttdoc">Normal distributed random number. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00111">Random.cpp:111</a></div></div>
<div class="ttc" id="group__Core_html_a22b7848147a9fecaa227fe4170ae6c6f"><div class="ttname"><a href="group__Core.html#a22b7848147a9fecaa227fe4170ae6c6f">crpropa::Random::randRayleigh</a></div><div class="ttdeci">double randRayleigh(double sigma)</div><div class="ttdoc">Rayleigh distributed random number. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00121">Random.cpp:121</a></div></div>
<div class="ttc" id="group__Core_html_a4be5586c72dbb90585801c742f4f3c92"><div class="ttname"><a href="group__Core.html#a4be5586c72dbb90585801c742f4f3c92">crpropa::Random::initialize</a></div><div class="ttdeci">void initialize(const uint32_t oneSeed)</div><div class="ttdoc">Initialize generator state with seed See Knuth TAOCP Vol 2, 3rd Ed, p.106 for multiplier. In previous versions, most significant bits (MSBs) of the seed affect only MSBs of the state array. Modified 9 Jan 2002 by Makoto Matsumoto. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00379">Random.cpp:379</a></div></div>
<div class="ttc" id="group__Core_html_a72fcc3b309bcab75050c60ffa2659e3e"><div class="ttname"><a href="group__Core.html#a72fcc3b309bcab75050c60ffa2659e3e">crpropa::Random::randVector</a></div><div class="ttdeci">Vector3d randVector()</div><div class="ttdoc">Random point on a unit-sphere. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00141">Random.cpp:141</a></div></div>
<div class="ttc" id="group__Core_html_a61c9eacb9b10051428e5302d47b43c6f"><div class="ttname"><a href="group__Core.html#a61c9eacb9b10051428e5302d47b43c6f">crpropa::Random::randVectorAroundMean</a></div><div class="ttdeci">Vector3d randVectorAroundMean(const Vector3d &amp;meanDirection, double angle)</div><div class="ttdoc">Random vector with given angular separation around mean direction. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00148">Random.cpp:148</a></div></div>
<div class="ttc" id="group__Core_html_abb08d2082cd8525b8968d45ba6b06378"><div class="ttname"><a href="group__Core.html#abb08d2082cd8525b8968d45ba6b06378">crpropa::Random::randBrokenPowerLaw</a></div><div class="ttdeci">double randBrokenPowerLaw(double index1, double index2, double breakpoint, double min, double max)</div><div class="ttdoc">Broken power-law distribution. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00207">Random.cpp:207</a></div></div>
<div class="ttc" id="group__Core_html_a546a92d9acde0f1337fb3c80787ac4b6"><div class="ttname"><a href="group__Core.html#a546a92d9acde0f1337fb3c80787ac4b6">crpropa::Random::randVectorLamberts</a></div><div class="ttdeci">Vector3d randVectorLamberts()</div><div class="ttdoc">Random lamberts distributed vector with theta distribution: sin(t) * cos(t), aka cosine law (https://...</div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00164">Random.cpp:164</a></div></div>
<div class="ttc" id="group__Core_html_adfd027765dc6de35f4305204edf51622"><div class="ttname"><a href="group__Core.html#adfd027765dc6de35f4305204edf51622">crpropa::Random::randExc</a></div><div class="ttdeci">double randExc()</div><div class="ttdoc">real number in [0,1) </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00088">Random.cpp:88</a></div></div>
<div class="ttc" id="group__Core_html_af0de4b4127be745f3a835f316c6d2d03"><div class="ttname"><a href="group__Core.html#af0de4b4127be745f3a835f316c6d2d03">crpropa::Random::reload</a></div><div class="ttdeci">void reload()</div><div class="ttdoc">Generate N new values in state Made clearer and faster by Matthew Bellew (matthew.bellew@home.com) </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00390">Random.cpp:390</a></div></div>
<div class="ttc" id="group__Core_html_af236dea62d3fe3989b66efea3d803d6c"><div class="ttname"><a href="group__Core.html#af236dea62d3fe3989b66efea3d803d6c">crpropa::Random::seed</a></div><div class="ttdeci">void seed(const uint32_t oneSeed)</div><div class="ttdoc">Seed the generator with a simple uint32_t. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00309">Random.cpp:309</a></div></div>
<div class="ttc" id="group__Core_html_a540919a8c8868928fffce58c66d1b91e"><div class="ttname"><a href="group__Core.html#a540919a8c8868928fffce58c66d1b91e">crpropa::Random::randDblExc</a></div><div class="ttdeci">double randDblExc()</div><div class="ttdoc">real number in (0,1) </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00096">Random.cpp:96</a></div></div>
<div class="ttc" id="group__Core_html_a59845772e010c85222696da08143282d"><div class="ttname"><a href="group__Core.html#a59845772e010c85222696da08143282d">crpropa::Random::randFisherVector</a></div><div class="ttdeci">Vector3d randFisherVector(const Vector3d &amp;meanDirection, double kappa)</div><div class="ttdoc">Fisher distributed random vector. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00155">Random.cpp:155</a></div></div>
<div class="ttc" id="group__Core_html_a81c75a710fe75ed3ea662b23591dd171"><div class="ttname"><a href="group__Core.html#a81c75a710fe75ed3ea662b23591dd171">crpropa::Random::randConeVector</a></div><div class="ttdeci">Vector3d randConeVector(const Vector3d &amp;meanDirection, double angularRadius)</div><div class="ttdoc">Uniform distributed random vector inside a cone. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00159">Random.cpp:159</a></div></div>
<div class="ttc" id="group__Core_html_ac4c22a5f0d4edb44e3cee1d6bbd5150b"><div class="ttname"><a href="group__Core.html#ac4c22a5f0d4edb44e3cee1d6bbd5150b">crpropa::Random::randInt</a></div><div class="ttdeci">uint32_t randInt()</div><div class="ttdoc">integer in [0,2^32-1] </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00249">Random.cpp:249</a></div></div>
<div class="ttc" id="group__Core_html_abcd421d6ac5d8720014afa6e6e9ec9af"><div class="ttname"><a href="group__Core.html#abcd421d6ac5d8720014afa6e6e9ec9af">crpropa::Random::randomInterpolatedPosition</a></div><div class="ttdeci">Vector3d randomInterpolatedPosition(const Vector3d &amp;a, const Vector3d &amp;b)</div><div class="ttdoc">_Position vector uniformly distributed within propagation step size bin </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00185">Random.cpp:185</a></div></div>
<div class="ttc" id="group__Core_html_a957487771e79552480efa2f2ed887261"><div class="ttname"><a href="group__Core.html#a957487771e79552480efa2f2ed887261">crpropa::Random::randInt64</a></div><div class="ttdeci">uint64_t randInt64()</div><div class="ttdoc">integer in [0, 2**64 -1]. PROBABLY NOT SECURE TO USE </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00281">Random.cpp:281</a></div></div>
<div class="ttc" id="group__Core_html_a78309d923f245b6acf167260194ba6e1"><div class="ttname"><a href="group__Core.html#a78309d923f245b6acf167260194ba6e1">crpropa::Random::rand</a></div><div class="ttdeci">double rand()</div><div class="ttdoc">real number in [0,1] </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00080">Random.cpp:80</a></div></div>
<div class="ttc" id="group__Core_html_a0ef89b01dbab3b7af11d83ebbb088caf"><div class="ttname"><a href="group__Core.html#a0ef89b01dbab3b7af11d83ebbb088caf">crpropa::Random::randFisher</a></div><div class="ttdeci">double randFisher(double k)</div><div class="ttdoc">Fisher distributed random number. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00125">Random.cpp:125</a></div></div>
<div class="ttc" id="group__Core_html_a78c8e327d0192e2a6c1df70828a86ec6"><div class="ttname"><a href="group__Core.html#a78c8e327d0192e2a6c1df70828a86ec6">crpropa::Random::seed</a></div><div class="ttdeci">void seed()</div><div class="ttdoc">Seed the generator with an array from /dev/urandom if available Otherwise use a hash of time() and cl...</div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00357">Random.cpp:357</a></div></div>
<div class="ttc" id="group__Core_html_ae4ba0f616e8362a265632cb6ab796b52"><div class="ttname"><a href="group__Core.html#ae4ba0f616e8362a265632cb6ab796b52">crpropa::Random::hash</a></div><div class="ttdeci">static uint32_t hash(time_t t, clock_t c)</div><div class="ttdoc">Get a uint32_t from t and c Better than uint32_t(x) in case x is floating point in [0...</div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00402">Random.cpp:402</a></div></div>
<div class="ttc" id="namespacecrpropa_html"><div class="ttname"><a href="namespacecrpropa.html">crpropa</a></div><div class="ttdoc">base64 encodig and decoding. </div><div class="ttdef"><b>Definition:</b> <a href="AdvectionField_8h_source.html#l00015">AdvectionField.h:15</a></div></div>
<div class="ttc" id="group__Core_html_a0cd29fd1c9f315dbd0630fc3462d9831"><div class="ttname"><a href="group__Core.html#a0cd29fd1c9f315dbd0630fc3462d9831">crpropa::Random::randPowerLaw</a></div><div class="ttdeci">double randPowerLaw(double index, double min, double max)</div><div class="ttdoc">Power-law distribution of a given differential spectral index. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00189">Random.cpp:189</a></div></div>
<div class="ttc" id="group__Core_html_a676ea228bb8be981a245f243599be2ba"><div class="ttname"><a href="group__Core.html#a676ea228bb8be981a245f243599be2ba">crpropa::Random::randUniform</a></div><div class="ttdeci">double randUniform(double min, double max)</div><div class="ttdoc">Uniform distribution in [min, max]. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00117">Random.cpp:117</a></div></div>
<div class="ttc" id="group__Core_html_ae021627627a0dbdbd19b503a3955dcc9"><div class="ttname"><a href="group__Core.html#ae021627627a0dbdbd19b503a3955dcc9">crpropa::Random::rand53</a></div><div class="ttdeci">double rand53()</div><div class="ttdoc">Access to 53-bit random numbers (capacity of IEEE double precision) </div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00104">Random.cpp:104</a></div></div>
<div class="ttc" id="group__Core_html"><div class="ttname"><a href="group__Core.html">crpropa::Vector3&lt; double &gt;</a></div></div>
<div class="ttc" id="group__Core_html_ab70ffcf4477320f22f8c4b70756f60ed"><div class="ttname"><a href="group__Core.html#ab70ffcf4477320f22f8c4b70756f60ed">crpropa::Random::randBin</a></div><div class="ttdeci">size_t randBin(const std::vector&lt; float &gt; &amp;cdf)</div><div class="ttdoc">Draw a random bin from a (unnormalized) cumulative distribution function, without leading zero...</div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00129">Random.cpp:129</a></div></div>
<div class="ttc" id="classcrpropa_1_1Base64_html_ac4125aa2e036339b53fefabaab922bd5"><div class="ttname"><a href="classcrpropa_1_1Base64.html#ac4125aa2e036339b53fefabaab922bd5">crpropa::Base64::encode</a></div><div class="ttdeci">static std::string encode(const unsigned char *src, size_t len)</div><div class="ttdoc">Encodes data. </div><div class="ttdef"><b>Definition:</b> <a href="base64_8cpp_source.html#l00026">base64.cpp:26</a></div></div>
<div class="ttc" id="group__Core_html_aa0cd23a16025cfeef7b8810eeb2a5d36"><div class="ttname"><a href="group__Core.html#aa0cd23a16025cfeef7b8810eeb2a5d36">crpropa::Random::Random</a></div><div class="ttdeci">Random()</div><div class="ttdoc">auto-initialize with /dev/urandom or time() and clock() Do NOT use for CRYPTOGRAPHY without securely ...</div><div class="ttdef"><b>Definition:</b> <a href="Random_8cpp_source.html#l00076">Random.cpp:76</a></div></div>
<div class="ttc" id="group__Core_html_classcrpropa_1_1Random"><div class="ttname"><a href="group__Core.html#classcrpropa_1_1Random">crpropa::Random</a></div><div class="ttdoc">Random number generator. </div><div class="ttdef"><b>Definition:</b> <a href="Random_8h_source.html#l00097">Random.h:97</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 8 2020 17:14:06 for CRPropa 3 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
